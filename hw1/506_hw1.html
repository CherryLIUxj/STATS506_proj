<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Xingjian Liu">

<title>STATS506_hw1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="506_hw1_files/libs/clipboard/clipboard.min.js"></script>
<script src="506_hw1_files/libs/quarto-html/quarto.js"></script>
<script src="506_hw1_files/libs/quarto-html/popper.min.js"></script>
<script src="506_hw1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="506_hw1_files/libs/quarto-html/anchor.min.js"></script>
<link href="506_hw1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="506_hw1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="506_hw1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="506_hw1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="506_hw1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STATS506_hw1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Xingjian Liu </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="problem-1---wine-data" class="level1">
<h1>Problem 1 - Wine data</h1>
<p>From <a href="https://archive.ics.uci.edu/dataset/109/wine" class="uri">https://archive.ics.uci.edu/dataset/109/wine</a>, download the data set about wine. It contains two files of interest - “wine.data” with the actual rectangular data set, and “wine.names” with some information about the data. (Both files are plain-text - you can open then in any text editor, including directly in RStudio.)</p>
<section id="a.-import-the-data-into-a-data.frame-in-r.-use-the-information-in-the-wine.names-file-to-give-appropriate-column-names.-note-downloading-and-unzipping-the-file-can-take-place-outside-of-your-submitted-document-but-importing-the-file-should-be-in-the-submission." class="level2">
<h2 class="anchored" data-anchor-id="a.-import-the-data-into-a-data.frame-in-r.-use-the-information-in-the-wine.names-file-to-give-appropriate-column-names.-note-downloading-and-unzipping-the-file-can-take-place-outside-of-your-submitted-document-but-importing-the-file-should-be-in-the-submission.">a. Import the data into a <code>data.frame</code> in R. Use the information in the “wine.names” file to give appropriate column names. (Note: Downloading and unzipping the file can take place outside of your submitted document, but importing the file should be in the submission.)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'wine/wine.data'</span>,<span class="at">header=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  V1    V2   V3   V4   V5  V6   V7   V8   V9  V10  V11  V12  V13  V14
1  1 14.23 1.71 2.43 15.6 127 2.80 3.06 0.28 2.29 5.64 1.04 3.92 1065
2  1 13.20 1.78 2.14 11.2 100 2.65 2.76 0.26 1.28 4.38 1.05 3.40 1050
3  1 13.16 2.36 2.67 18.6 101 2.80 3.24 0.30 2.81 5.68 1.03 3.17 1185
4  1 14.37 1.95 2.50 16.8 113 3.85 3.49 0.24 2.18 7.80 0.86 3.45 1480
5  1 13.24 2.59 2.87 21.0 118 2.80 2.69 0.39 1.82 4.32 1.04 2.93  735
6  1 14.20 1.76 2.45 15.2 112 3.27 3.39 0.34 1.97 6.75 1.05 2.85 1450</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   wine.names: name of 13 attributes</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   1) Alcohol</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   2) Malic acid</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   3) Ash</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   4) Alcalinity of ash  </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   5) Magnesium</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   6) Total phenols</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   7) Flavanoids</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   8) Nonflavanoid phenols</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   9) Proanthocyanins</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   10)Color intensity</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   11)Hue</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   12)OD280/OD315 of diluted wines</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   13)Proline </span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span> <span class="fu">setNames</span>(wine, <span class="fu">c</span>(<span class="st">'Class'</span>,<span class="st">'Alcohol'</span>,<span class="st">'Malic acid'</span>,<span class="st">'Ash'</span>,<span class="st">'Alcalinity of ash'</span>,<span class="st">'Magnesium'</span>,<span class="st">'Total phenols'</span>,<span class="st">'Flavanoids'</span>,<span class="st">'Nonflavanoid phenols'</span>,<span class="st">'Proanthocyanins'</span>,<span class="st">'Color intensity'</span>,<span class="st">'Hue'</span>,<span class="st">'OD280/OD315 of diluted wines'</span>,<span class="st">'Proline'</span>))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Class Alcohol Malic acid  Ash Alcalinity of ash Magnesium Total phenols
1     1   14.23       1.71 2.43              15.6       127          2.80
2     1   13.20       1.78 2.14              11.2       100          2.65
3     1   13.16       2.36 2.67              18.6       101          2.80
4     1   14.37       1.95 2.50              16.8       113          3.85
5     1   13.24       2.59 2.87              21.0       118          2.80
6     1   14.20       1.76 2.45              15.2       112          3.27
  Flavanoids Nonflavanoid phenols Proanthocyanins Color intensity  Hue
1       3.06                 0.28            2.29            5.64 1.04
2       2.76                 0.26            1.28            4.38 1.05
3       3.24                 0.30            2.81            5.68 1.03
4       3.49                 0.24            2.18            7.80 0.86
5       2.69                 0.39            1.82            4.32 1.04
6       3.39                 0.34            1.97            6.75 1.05
  OD280/OD315 of diluted wines Proline
1                         3.92    1065
2                         3.40    1050
3                         3.17    1185
4                         3.45    1480
5                         2.93     735
6                         2.85    1450</code></pre>
</div>
</div>
</section>
<section id="b.-the-data-contains-information-on-three-different-classes-of-wine.-ensure-that-the-number-of-wines-within-each-class-is-correct-as-reported-in-wine.names." class="level2">
<h2 class="anchored" data-anchor-id="b.-the-data-contains-information-on-three-different-classes-of-wine.-ensure-that-the-number-of-wines-within-each-class-is-correct-as-reported-in-wine.names.">b. The data contains information on three different classes of wine. Ensure that the number of wines within each class is correct as reported in “wine.names”.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wine<span class="sc">$</span>Class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3 
59 71 48 </code></pre>
</div>
</div>
<pre><code>It is correspondent with that reported in 'wine.names' file</code></pre>
</section>
<section id="c.-use-the-data-to-answer-the-following-questions" class="level2">
<h2 class="anchored" data-anchor-id="c.-use-the-data-to-answer-the-following-questions">c.&nbsp;Use the data to answer the following questions:</h2>
<ol type="1">
<li><p>The wine with the highest alcohol content belongs to which class?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">'The wine with the highest alcohol content belongs to Class %d'</span>,wine[<span class="fu">which</span>(wine<span class="sc">$</span>Alcohol <span class="sc">==</span> <span class="fu">max</span>(wine<span class="sc">$</span>Alcohol)),<span class="st">'Class'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The wine with the highest alcohol content belongs to Class 1"</code></pre>
</div>
</div></li>
<li><p>The wine with the lowest alcohol content belongs to which class?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">'The wine with the lowest alcohol content belongs to Class %d'</span>, wine[<span class="fu">which</span>(wine<span class="sc">$</span>Alcohol <span class="sc">==</span> <span class="fu">min</span>(wine<span class="sc">$</span>Alcohol)),<span class="st">'Class'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The wine with the lowest alcohol content belongs to Class 2"</code></pre>
</div>
</div></li>
<li><p><a href="https://mgwater.com/beer.shtml">German beers have, on average, 114 mg/l of magnesium</a>. How many of these wines have higher levels of magnesium than that? (You may assume that the magnesium reported in the data is in the same units.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">'%d wines have higher levels of magnesium than 114 mg/l'</span>,<span class="fu">nrow</span>(wine[<span class="fu">which</span>(wine<span class="sc">$</span>Magnesium <span class="sc">&gt;</span> <span class="dv">114</span>),]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "26 wines have higher levels of magnesium than 114 mg/l"</code></pre>
</div>
</div></li>
</ol>
<p>Within each class, how many wines have higher levels of magnesium than average German beer?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">'Within class 1, there are %d wines that have higher levels of magnesium than average German bee'</span>, <span class="fu">nrow</span>(wine[<span class="fu">which</span>(wine<span class="sc">$</span>Magnesium <span class="sc">&gt;</span> <span class="dv">114</span> <span class="sc">&amp;</span> wine<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">1</span>),]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Within class 1, there are 15 wines that have higher levels of magnesium than average German bee"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">'Within class 2, there are %d wines that have higher levels of magnesium than average German bee'</span>, <span class="fu">nrow</span>(wine[<span class="fu">which</span>(wine<span class="sc">$</span>Magnesium <span class="sc">&gt;</span> <span class="dv">114</span> <span class="sc">&amp;</span> wine<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">2</span>),]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Within class 2, there are 6 wines that have higher levels of magnesium than average German bee"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">'Within class 3, there are %d wines that have higher levels of magnesium than average German bee'</span>, <span class="fu">nrow</span>(wine[<span class="fu">which</span>(wine<span class="sc">$</span>Magnesium <span class="sc">&gt;</span> <span class="dv">114</span> <span class="sc">&amp;</span> wine<span class="sc">$</span>Class <span class="sc">==</span> <span class="dv">3</span>),]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Within class 3, there are 5 wines that have higher levels of magnesium than average German bee"</code></pre>
</div>
</div>
</section>
<section id="d.-create-a-table-identifying-the-average-value-of-each-variable-providing-one-row-for-the-overall-average-and-one-row-per-class-with-class-averages.-this-table-does-not-need-to-be-fancy-but-should-clearly-identify-what-each-value-represents." class="level2">
<h2 class="anchored" data-anchor-id="d.-create-a-table-identifying-the-average-value-of-each-variable-providing-one-row-for-the-overall-average-and-one-row-per-class-with-class-averages.-this-table-does-not-need-to-be-fancy-but-should-clearly-identify-what-each-value-represents.">d.&nbsp;Create a table identifying the average value of each variable, providing one row for the overall average, and one row per class with class averages. (This table does not need to be “fancy” but should clearly identify what each value represents.)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>wine_d <span class="ot">&lt;-</span> wine</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>wine_d1 <span class="ot">=</span> wine[<span class="fu">which</span>(wine<span class="sc">$</span>Class<span class="sc">==</span><span class="dv">1</span>),]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>wine_d2 <span class="ot">=</span> wine[<span class="fu">which</span>(wine<span class="sc">$</span>Class<span class="sc">==</span><span class="dv">2</span>),]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>wine_d3 <span class="ot">=</span> wine[<span class="fu">which</span>(wine<span class="sc">$</span>Class<span class="sc">==</span><span class="dv">3</span>),]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="fu">names</span>(wine_d)){</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name <span class="sc">!=</span> <span class="st">'Class'</span>) {</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    wine_d[<span class="dv">179</span>,name] <span class="ot">=</span> <span class="fu">mean</span>(wine[[name]])</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {<span class="cf">next</span>}</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="fu">names</span>(wine_d1)){</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name <span class="sc">!=</span> <span class="st">'Class'</span>) {</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    wine_d[<span class="dv">180</span>,name] <span class="ot">=</span> <span class="fu">mean</span>(wine_d1[[name]])</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {<span class="cf">next</span>}</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="fu">names</span>(wine_d2)){</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name <span class="sc">!=</span> <span class="st">'Class'</span>) {</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    wine_d[<span class="dv">181</span>,name] <span class="ot">=</span> <span class="fu">mean</span>(wine_d2[[name]])</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {<span class="cf">next</span>}</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="fu">names</span>(wine_d3)){</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name <span class="sc">!=</span> <span class="st">'Class'</span>) {</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    wine_d[<span class="dv">182</span>,name] <span class="ot">=</span> <span class="fu">mean</span>(wine_d3[[name]])</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {<span class="cf">next</span>}</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>table_d <span class="ot">&lt;-</span> wine_d[<span class="dv">179</span><span class="sc">:</span><span class="dv">182</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(table_d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'overall_avg'</span>,<span class="st">'class1_avg'</span>,<span class="st">'class2_avg'</span>,<span class="st">'class3_avg'</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>table_d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Alcohol Malic acid      Ash Alcalinity of ash Magnesium
overall_avg 13.00062   2.336348 2.366517          19.49494  99.74157
class1_avg  13.74475   2.010678 2.455593          17.03729 106.33898
class2_avg  12.27873   1.932676 2.244789          20.23803  94.54930
class3_avg  13.15375   3.333750 2.437083          21.41667  99.31250
            Total phenols Flavanoids Nonflavanoid phenols Proanthocyanins
overall_avg      2.295112  2.0292697            0.3618539        1.590899
class1_avg       2.840169  2.9823729            0.2900000        1.899322
class2_avg       2.258873  2.0808451            0.3636620        1.630282
class3_avg       1.678750  0.7814583            0.4475000        1.153542
            Color intensity       Hue OD280/OD315 of diluted wines   Proline
overall_avg        5.058090 0.9574494                     2.611685  746.8933
class1_avg         5.528305 1.0620339                     3.157797 1115.7119
class2_avg         3.086620 1.0562817                     2.785352  519.5070
class3_avg         7.396250 0.6827083                     1.683542  629.8958</code></pre>
</div>
</div>
</section>
<section id="e.-carry-out-a-series-of-t-tests-to-examine-whether-the-level-of-ash-differs-across-the-three-classes.-present-the-r-output-and-interpret-the-results.-you-may-use-an-existing-r-function-to-carry-out-the-t-test-or-for-minor-extra-credit-manually-write-your-own-calculation-of-the-t-test-p-values." class="level2">
<h2 class="anchored" data-anchor-id="e.-carry-out-a-series-of-t-tests-to-examine-whether-the-level-of-ash-differs-across-the-three-classes.-present-the-r-output-and-interpret-the-results.-you-may-use-an-existing-r-function-to-carry-out-the-t-test-or-for-minor-extra-credit-manually-write-your-own-calculation-of-the-t-test-p-values.">e. Carry out a series of t-tests to examine whether the level of Ash differs across the three classes. Present the R output and interpret the results. (You may use an existing R function to carry out the t-test, or for <strong>minor extra credit</strong>, manually write your own calculation of the t-test p-values.)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>t_test_12 <span class="ot">=</span> <span class="fu">t.test</span>(wine_d1<span class="sc">$</span>Ash, wine_d2<span class="sc">$</span>Ash)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>t_test_23 <span class="ot">=</span> <span class="fu">t.test</span>(wine_d2<span class="sc">$</span>Ash, wine_d3<span class="sc">$</span>Ash)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>t_test_13 <span class="ot">=</span> <span class="fu">t.test</span>(wine_d1<span class="sc">$</span>Ash, wine_d3<span class="sc">$</span>Ash)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  wine_d1$Ash and wine_d2$Ash
t = 4.4184, df = 125.59, p-value = 2.124e-05
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.116383 0.305226
sample estimates:
mean of x mean of y 
 2.455593  2.244789 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_23)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  wine_d2$Ash and wine_d3$Ash
t = -4.184, df = 114.96, p-value = 5.627e-05
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.2833328 -0.1012564
sample estimates:
mean of x mean of y 
 2.244789  2.437083 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  wine_d1$Ash and wine_d3$Ash
t = 0.46489, df = 105, p-value = 0.643
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.06043717  0.09745695
sample estimates:
mean of x mean of y 
 2.455593  2.437083 </code></pre>
</div>
</div>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation"><strong>Interpretation:</strong></h4>
<p>Parameter explanation:</p>
<ol type="1">
<li><p>t: refers to ‘t-value’ that measures the difference between two sample means.</p>
<p><span class="math display">\[t = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}\]</span></p></li>
<li><p>df: refers to “degrees of freedom.” It is adjusted in Welch t-test to account for the unequal variances and sample sizes.</p></li>
<li><p>p-value: Smaller p-value suggests higher probability of rejecting the null hypothesis. Typically we can reject the null hypothesis if p &lt;= 0.05</p>
<p><span class="math display">\[p = P(T&gt;|t|)
\]</span></p></li>
<li><p>alternative hypothesis: a statement that contradicts the null hypothesis, which means the difference between two sample means is great.</p></li>
<li><p>95 percent confidence interval: a 95 percent confidence interval can be written as</p>
<p><span class="math display">\[
\left( \bar{x} -  \lambda \times \frac{s}{\sqrt{n}}, \bar{x} + \lambda \times \frac{s}{\sqrt{n}} \right)
\]</span></p></li>
</ol>
<p>where λ is determined by <span class="math inline">\(P(|T|&lt;\lambda) = 5%\)</span></p>
<p>We can see from the t-test results above that the p-value of t_test_13 is much bigger than that of t_test_12 and t_test_23. That’s simply because the difference between the group mean of class1_ash and class3_ash is much smaller than that of the other two. And also, for t_test_12 and t_test_23, since the p-value is much smaller than 5%, we can reject the null hypothesis.</p>
</section>
</section>
</section>
<section id="problem-2---perfect-powers" class="level1">
<h1>Problem 2 - Perfect Powers</h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>